#
# Build configuration for Circle CI
#

general:
    artifacts:
        - /home/ubuntu/${CIRCLE_PROJECT_REPONAME}/app/build/outputs/apk/

machine:
    environment:
        ANDROID_HOME: /usr/local/android-sdk-linux

dependencies:
    override:
       - source tools/environmentSetup.sh && getAndroidSDK

test:
  override:
    - ./gradlew test
    - ./gradlew jacocoTestReport
    - ./gradlew assembleDebug pmd findbugs
    - cp -r /home/ubuntu/weatherapp/app/build/reports/tests $CIRCLE_ARTIFACTS
    - cp -r /home/ubuntu/weatherapp/app/build/outputs $CIRCLE_ARTIFACTS
    - sudo apt-get install dc
    - chmod +x ./checkCoverageGoal.sh
    - ./checkCoverageGoal.sh

deployment:
    development:
    branch: dev
    commands:
      - source tools/deployHockeyApp.sh && uploadToHockeyAppDevelopment
#
#deployment:
#    release:
#    branch: master
#    commands:
#      - source tools/deployHockeyApp.sh && uploadToHockeyRelease